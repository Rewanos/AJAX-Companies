$(function(){$(".main-content").hide(),$(".company_partners_list").hide(),$(".company_country").hide();$("#sel1");var a,p,t={firstName:function(){$(".name").append('<div id="nameInfo" class="info"></div>');var e=$("#nameInfo"),a=$("#firstName");a.offset();a.val().length<4?(t.errors=!0,e.removeClass("correct").addClass("error").html("← at least 4 characters").fadeIn(500),a.removeClass("normal").addClass("wrong")):(e.removeClass("error").addClass("correct").html('<i class="fas fa-check-circle fa-2x"></i>').fadeIn(500),a.removeClass("wrong").addClass("normal"))},secoundName:function(){$(".surname").append('<div id="surNameInfo" class="info"></div>');var e=$("#surNameInfo"),a=$("#secoundName");a.offset();a.val().length<4?(t.errors=!0,e.removeClass("correct").addClass("error").html("← at least 4 characters").fadeIn(500),a.removeClass("normal").addClass("wrong")):(e.removeClass("error").addClass("correct").html('<i class="fas fa-check-circle fa-2x"></i>').fadeIn(500),a.removeClass("wrong").addClass("normal"))},email:function(){$(".email").append('<div id="emailInfo" class="info"></div>');var e=$("#emailInfo"),a=$("#email");a.offset();/^.+@.+[.].{2,}$/i.test(a.val())?(e.removeClass("error").addClass("correct").html('<i class="fas fa-check-circle fa-2x"></i>').fadeIn(500),a.removeClass("wrong").addClass("normal")):(t.errors=!0,e.removeClass("correct").addClass("error").html("Give me a valid email adress)").fadeIn(500),a.removeClass("normal").addClass("wrong"))},password:function(){$(".pwd").append('<div id="passwordInfo" class="info col-sm-3"></div>');var e=$("#passwordInfo"),a=$("#pwd");a.offset();/(?=.*[0-9])(?=.*[!@#$%^&*])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z!@#$%^&*]{6,}/g.test(a.val())?(e.removeClass("error col-sm-3").addClass("correct").html('<i class="fas fa-check-circle fa-2x"></i>').fadeIn(500),a.removeClass("wrong").addClass("normal")):(t.errors=!0,e.removeClass("correct").addClass("error").html("At least 6 letters, contain: capital letter, small letter and special symbol").fadeIn(500),a.removeClass("normal").addClass("wrong"))},sendIt:function(){t.errors||$(".form-horizontal").submit()}};$("#send").on("click",function(e){return a={name:$("#firstName").val(),surname:$("#secoundName").val(),email:$("#email").val(),gender:$("#sel1").val(),password:$("#pwd").val()},e.preventDefault(),($(document)?$("body"):$("html")).animate({scrollTop:$(".form-horizontal").offset().top},750,function(){t.errors=!1,t.firstName(),t.secoundName(),t.email(),t.password(),t.sendIt()}),!1}),$("#firstName").change(t.firstName),$("#secoundName").change(t.secoundName),$("#email").change(t.email),$("#pwd").change(t.password),$(".form-horizontal").submit(function(e){$.ajax({type:"POST",url:"http://codeit.pro/codeitCandidates/serverFrontendTest/user/registration",data:a,dataType:"json",encode:!0}).done(function(e){console.log(e),"Field 'secondname' is required"==e.message&&"Form Error"==e.status?($(".header_form").fadeOut(500),$(".main-content").fadeIn(500),function(){var m=[];function u(e,a){return a.value-e.value}$.getJSON("http://codeit.pro/codeitCandidates/serverFrontendTest/company/getList",function(l){p=l;for(var t=[0,0,0,0,0,0],e=[],a=0;a<l.list.length;a++){var r=l.list[a];e.push(r.location.name)}var e=function(e){for(var a={},t=0;t<e.length;t++){var r=e[t];a[r]=!0}return Object.keys(a)}(e);function s(e,a){r.location.name==e&&(t[a]++,t[a]=t[a]*l.list.length/100)}console.log(e);var n=$(".company_list_ul"),o=$(".company_partners_ul"),i=$(".company_partners_list");$(".company_numb").append("<div>"+l.list.length+"</div>");for(var a=0;a<l.list.length;a++){var r=l.list[a];s(e[0],0),s(e[1],1),s(e[2],2),s(e[3],3),s(e[4],4),s(e[5],5),n.append("<li id="+r.name+">"+r.name+"</li>")}v=e.map(function(e,a){return{country:e,value:t[a],pulled:!1}});var d="highlight",c=$(".company_list_ul li").click(function(e){c.removeClass(d),$(this).addClass(d)});n.on("click",function(e){for(var a=0;a<l.list.length;a++){i.fadeOut(5);var t=l.list[a],r=e.target.id;if(r==t.name){o.html("");for(var s=0;s<t.partners.length;s++){var n=t.partners;n=(m=n).sort(u),o.append("<li><span>"+n[s].name+"</span> "+n[s].value+"%")}}}i.fadeIn(200)})}).done(function(){$(".loader").delay(500).fadeOut(500)}),$(".company_partners_buttons").on("click",function(e){var t=e.target.dataset.type,a=$(".company_partners_ul");if(1==m.length)return;a.html(""),m=m[0][t]>m[1][t]?m.sort(function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0}):m.sort(function(e,a){return e[t]<a[t]?1:e[t]>a[t]?-1:0});for(var r=0;r<m.length;r++)a.append("<li><span>"+m[r].name+"</span> "+m[r].value+"%")}),$(".company_country_button").on("click",function(){$(".company_country").fadeOut(500),$("#chartdiv").fadeIn(500)}),$(".company_partners_list").on("dblclick",function(){$(".company_partners_list").fadeOut(500)}),$.getJSON("http://codeit.pro/codeitCandidates/serverFrontendTest/news/getList",function(e){for(var a=0;a<e.list.length;a++){var t=e.list[a],r=new Date(1e3*t.date),s=r.getDay(),n=r.getMonth();s<10&&(s="0"+s),n<10&&(n="0"+n);var l=s+"."+n+"."+r.getFullYear();$(".news-block .swiper-wrapper").append('<div class="swiper-slide"><img class="news-image" src="'+t.img+'"><div class="slider-text"><h1 class="title"><a href=https://'+t.link+">"+t.link+'</a></h1><p class="news-text">'+t.description+'</p><span class="news-author"><strong>Автор:</strong> '+t.author+'</span><p><span class="news-date"><strong>Дата:</strong> '+l+"</span></p></div></div>")}}).done(function(){$(".loader").delay(500).fadeOut(500);$(".news-text").each(function(){var e=$(this).text();50<e.length&&$(this).text(e.slice(0,50)+"...")});new Swiper(".swiper-container",{direction:"horizontal",loop:!0,pagination:{el:".swiper-pagination"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})})}()):"Email is not valid"==e.message&&"Form Error"==e.status?alert(e.message+" "+e.status):"Field 'gender' is required"==e.message&&"Form Error"==e.status?alert(e.message+" "+e.status):"Field 'secondname' should contain from 3 to 60 letters"==e.message&&"Form Error"==e.status?alert(e.message+" "+e.status):"Creating user error. Email already exists."==e.message&&"Error"==e.status?alert(e.message+" "+e.status):"Wrong route"==e.message&&"Error"==e.status&&alert(e.message+" "+e.status)}),e.preventDefault()});var e=AmCharts.makeChart("chartdiv",{type:"pie",theme:"light",valueField:"value",titleField:"country",pulledField:"pulled",outlineAlpha:.4,depth3D:25,balloonText:"[[title]]<br><span style='font-size:14px'><b>[[value]]</b> ([[percents]]%)</span>",angle:30,responsive:{enabled:!0,rules:[{maxWidth:400,overrides:{legend:{enabled:!0}}},{maxWidth:300,overrides:{valueAxes:{inside:!0}}},{maxWidth:200,overrides:{valueAxes:{labelsEnabled:!1}}}]},listeners:[{event:"clickSlice",method:function(e){var a=e.dataItem.title;$(".company_country_list").html(""),$("#chartdiv").fadeOut(500);for(var t=0;t<p.list.length;t++){var r=p.list[t];r.location.name==a&&$(".company_country_list").append("<li>"+r.name+"</li>")}$(".company_country").fadeIn(500),e.chart.validateData()}}]}),v=[{country:"Poland",value:34,pulled:!1},{country:"Ukraine",value:18,pulled:!1},{country:"United States",value:23,pulled:!1},{country:"Norway",value:4,pulled:!1},{country:"Sweden",value:18,pulled:!1},{country:"Germany",value:3,pulled:!1}];e.dataProvider=v,e.responsive={enabled:!0}});